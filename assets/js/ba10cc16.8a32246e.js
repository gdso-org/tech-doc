"use strict";(self.webpackChunktech_doc=self.webpackChunktech_doc||[]).push([[430],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(n),u=r,g=m["".concat(s,".").concat(u)]||m[u]||c[u]||i;return n?a.createElement(g,o(o({ref:t},p),{},{components:n})):a.createElement(g,o({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3423:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:2},o="1. ONS resolution",l={unversionedId:"getting-started/ons-resolution",id:"getting-started/ons-resolution",title:"1. ONS resolution",description:"GDSO\u2019s Tire Information Service (TIS) does not own data from all RFID tires of every tire manufacturer. Its role is to",source:"@site/docs/getting-started/ons-resolution.md",sourceDirName:"getting-started",slug:"/getting-started/ons-resolution",permalink:"/tech-doc/docs/getting-started/ons-resolution",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/getting-started/ons-resolution.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"How it works ?",permalink:"/tech-doc/docs/getting-started/how-it-works"},next:{title:"2. Authentication",permalink:"/tech-doc/docs/getting-started/authentication"}},s={},d=[{value:"1.1 Obtain a GS1 Identification Key from UII",id:"11-obtain-a-gs1-identification-key-from-uii",level:2},{value:"1.2. Transform GS1 Identification Key to a valid key for ONS (Fully Qualified Domain Name)",id:"12-transform-gs1-identification-key-to-a-valid-key-for-ons-fully-qualified-domain-name",level:2},{value:"1.3. Request the ONS to find the URL endpoint",id:"13-request-the-ons-to-find-the-url-endpoint",level:2},{value:"Example 1 (using google DNS resolve):",id:"example-1-using-google-dns-resolve",level:4},{value:"Example 2 (using \u2018dig\u2019 command):",id:"example-2-using-dig-command",level:4}],p={toc:d},m="wrapper";function c(e){let{components:t,...i}=e;return(0,r.kt)(m,(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"1-ons-resolution"},"1. ONS resolution"),(0,r.kt)("p",null,"GDSO\u2019s Tire Information Service (TIS) does not own data from all RFID tires of every tire manufacturer. Its role is to\nguide the user to the appropriate Tire manufacturer\u2019s service. It is this service, belonging to each manufacturer,\nthat will provide the data followwing a standardized format that is shared with the others."),(0,r.kt)("p",null,"Therefore, the ONS resolution step is here to deliver the right API URL that a user would be able to call to\nget the data about his tire."),(0,r.kt)("p",null,"To identify the company that made the tire that was scanned, it uses what is called a \u2018company prefix\u2019 which\nis encoded in UII . Based on this information, the TIS will know which company\u2019s API has to be\ncalled. The actions required to extract the company prefix and use the Resolution service are described\nbelow."),(0,r.kt)("h2",{id:"11-obtain-a-gs1-identification-key-from-uii"},"1.1 Obtain a GS1 Identification Key from UII"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Capture a valid EPC/UII by scanning a tire for example. A valid UII shall follow ISO 20909/20910\nstandards. According to these ISO standards, this identifier should follow SGTIN-96 standard (96 bits of data).")),(0,r.kt)("p",null,"Example of SGTIN-96 (hexadecimal) captured by a system: ",(0,r.kt)("strong",{parentName:"p"},"30105E30A70457000021E88E")," "),(0,r.kt)("p",null,"Depending on the capture system level, EPC could be written in different ways: Raw (hexadecimal), Tag URI,  Pure Identity URI."),(0,r.kt)("p",null,"According to the previous example, here the different EPC format"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"RAW (Hexadecimal)")),(0,r.kt)("td",{parentName:"tr",align:null},"30105E30A70457000021E88E")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Tag URI")),(0,r.kt)("td",{parentName:"tr",align:null},"urn:epc:tag:sgtin-96:0.12345678.04444.2222222")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Pure Identity URI")),(0,r.kt)("td",{parentName:"tr",align:null},"urn:epc:id:sgtin:12345678.04444.2222222")))),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"According to ONS 2.01 standard in order to query the DNS for an UII, the identifier must be converted to a GS1 Identification Key in order to convert it for ONS resolution.\nIn TIS context, GS1 Identification Key needed is GTIN (Global Trade Item Number).")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"GS1Key translation",src:n(3946).Z,width:"2480",height:"1394"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"How to know the size of Company Prefix/ Indicator digit & item reference column?"),(0,r.kt)("p",{parentName:"admonition"},"Please refer to the partition value and the following table:\n",(0,r.kt)("img",{alt:"SGTIN Partition Table",src:n(5102).Z,width:"563",height:"464"}))),(0,r.kt)("p",null,"At this stage, the ",(0,r.kt)("strong",{parentName:"p"},"GS1 Identification Key")," obtained is a GTIN: ",(0,r.kt)("inlineCode",{parentName:"p"},"01234567844442"),"."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"It exists some libraries/tools to perform the conversion:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.gs1.org/services/epc-encoderdecoder"},"S1 EPC encoding/decoding tools")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/jlcout/epctagcoder"},"EPCtagCoder by jlcout")))),(0,r.kt)("h2",{id:"12-transform-gs1-identification-key-to-a-valid-key-for-ons-fully-qualified-domain-name"},"1.2. Transform GS1 Identification Key to a valid key for ONS (Fully Qualified Domain Name)"),(0,r.kt)("p",null,"In general, the format of the first valid key for ONS is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"<transformation of the identification key>.<identification key type>.<organisation\nnamespace>.id.<valid ONS Peer Root domain name>\n")),(0,r.kt)("p",null,"The first valid key as follows:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Append a transformation of the GS1 Identification Key (GTIN obtained in the previous step 1.1) within\nthe AUS.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Strip the checksum digit, if applicable.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0123456784444 2 --\x3e 0123456784444\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Hold the leading digit (in this case GTIN indicator digit) in its position")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0 123456784444\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Reverse all the remaining characters.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0 123456784444 --\x3e 0 444487654321\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"For each character, append a \u2018.\u2019 (period).")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0444487654321 --\x3e 0.4.4.4.4.8.7.6.5.4.3.2.1\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Append the identification key type, in this case: \u201cgtin\u201c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0.4.4.4.4.8.7.6.5.4.3.2.1.gtin\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Append \u201c.gs1.id.\u201d")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Append a valid ONS root domain name, in TIS case: \u201ctesting.gdso.org \u201c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org\n")),(0,r.kt)("p",null,"Root domain may be different depending on the environment you would like to use: Testing environment or\nProduction environment (See ",(0,r.kt)("a",{parentName:"p",href:"/tech-doc/docs/getting-started/tis-env"},"TIS Environnment")," for the root domains)."),(0,r.kt)("h2",{id:"13-request-the-ons-to-find-the-url-endpoint"},"1.3. Request the ONS to find the URL endpoint"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Once you have the URL to request (result of step 1.2) you will have to launch a DNS NAPTR request to\nresolve this URL. You should receive the following information in answer:")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"DNS google answer",src:n(2970).Z,width:"1138",height:"122"})),(0,r.kt)("p",null,"The most important information in this answer will be:"),(0,r.kt)("p",null,"The service name (in orange in the example below) /!\\ Service name format may evolve in the\nfuture.\nThe Regexp (in green in the example below) which contains the URL to the specific tire\nmanufacturer\u2019s API"),(0,r.kt)("h4",{id:"example-1-using-google-dns-resolve"},"Example 1 (using google DNS resolve):"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://dns.google/resolve?name=0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org&type=NAPTR"},"https://dns.google/resolve?name=0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org&type=NAPTR"),"\nAnswer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'{\n  "Status": 0,\n  "TC": false,\n  "RD": true,\n  "RA": true,\n  "AD": false,\n  "CD": false,\n  "Question": [\n    {\n      "name": "0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org.",\n      "type": 35\n    }\n  ],\n  "Answer": [\n    {\n      "name": "0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org.",\n      "type": 35,\n      "TTL": 60,\n      "data": "0 0 u GetTireBySgtin !^.*$!https://example.com/tire/! ."\n    },\n    {\n      "name": "0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org.",\n      "type": 35,\n      "TTL": 60,\n      "data": "0 0 u GetTireByBatch !^.*$!https://example.com/tire/! ."\n    }\n  ],\n  "Comment": "Response from 205.251.198.161."\n}\n')),(0,r.kt)("h4",{id:"example-2-using-dig-command"},"Example 2 (using \u2018dig\u2019 command):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"dig -t NAPTR 0.4.4.4.4.8.7.6.5.4.3.2.1.gtin.gs1.id.testing.gdso.org\n")),(0,r.kt)("p",null,"Answer:\n",(0,r.kt)("img",{alt:"Resolver answer",src:n(6517).Z,width:"1083",height:"290"})),(0,r.kt)("p",null,"The resolution may sometimes return more than 1 service (unlike the example above)."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Then you may select the appropriate service that you will use to request data from the tire\u2019s\nmanufacturer in the following steps. ")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The service to retrieve standard data from one UII MUST be named ",(0,r.kt)("strong",{parentName:"li"},"GetTireBySgtin")),(0,r.kt)("li",{parentName:"ul"},"The service to retrieve standard data from a list of UIIs (100 max) MUST be named ",(0,r.kt)("strong",{parentName:"li"},"GetTireByBatch"))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Retrieve the regexp associated to the chosen service name:")),(0,r.kt)("p",null,"Example: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"!^.*$! https://example.com/tire/!\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Extract the API URL from it")),(0,r.kt)("p",null,"Example: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"https://example.com/tire/\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"It exists some libraries/tools available to request TIS Resolver:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://dns.google/resolve?name=%3Cvalid_key%3E&type=NAPTR"},"Google DNS resolve (using HTTP request)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/dnsjava/dnsjava"},"Java library with NAPTR request implementation")))))}c.isMDXComponent=!0},2970:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/example_dnsgoogle_resolver-8cfb7d1b23a24eba0c50a9751d8a10f3.png"},6517:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/example_resolver_answer-dc5c257b00fe629914cee5277cc684e5.png"},3946:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gs1_key_translation-98c0ae916aa61e5ccbbf5860d8291777.png"},5102:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/sgtin_partition_table-c6de55ea4dd339d5cf834b49dee03f10.png"}}]);